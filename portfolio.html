<!DOCTYPE html>
<html lang="en" class="h-full" style="background: var(--color-bg-main);">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Profile - Nimbus Trading Platform</title>

  <!-- Fonts: Geist + Geist Mono -->
  <link href="https://cdn.jsdelivr.net/npm/@fontsource/geist/400.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/@fontsource/geist/500.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/@fontsource/geist/600.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/@fontsource/geist/700.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/@fontsource/geist-mono/400.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/@fontsource/geist-mono/500.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/@fontsource/geist-mono/600.css" rel="stylesheet">

  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="stylesheet" href="assets/css/components.css">
  <script src="assets/js/navbar.js"></script>

  <style>
    /* Portfolio Book Styles */
    input[type="radio"] {
      width: 1rem;
      height: 1rem;
      accent-color: #10B981;
    }

    .border {
      border-color: var(--color-border-subtle);
    }

    .tab-btn {
      position: relative;
      font-size: 0.875rem;
      color: #9CA3AF;
      transition-property: color;
      transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
      transition-duration: 150ms;
    }
    .tab-btn:hover {
      color: #FFFFFF;
    }

    .tab-btn.active {
      color: #FFFFFF;
      border-color: var(--color-accent);
    }

    .calendar-day {
      height: 5rem;
      padding: 0.5rem;
      border-radius: 0.25rem;
      border-width: 1px;
      text-align: center;
      font-size: 0.875rem;
      transition-property: background-color;
      transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
      transition-duration: 150ms;
    }
    .calendar-day:hover {
      background-color: rgba(255, 255, 255, 0.05);
    }

    .calendar-day.profit {
      border-color: rgba(16, 185, 129, 0.3);
      background-color: rgba(16, 185, 129, 0.1);
    }

    .calendar-day.loss {
      border-color: rgba(239, 68, 68, 0.3);
      background-color: rgba(239, 68, 68, 0.1);
    }

    .calendar-day.today {
      border-color: var(--color-accent);
    }

    .calendar-day.empty {
      border-color: transparent;
      background-color: transparent;
      pointer-events: none;
    }
  </style>
</head>

<body class="h-full text-gray-200 antialiased bg-gradient-main">
  <div class="min-h-screen flex flex-col">
    <!-- Navbar Container -->
    <div id="navbar-container"></div>

    <!-- Main Content -->
    <main id="portfolio-book" class="min-h-screen">
      <!-- PAGE CONTAINER -->
      <section class="max-w-7xl mx-auto px-4 md:px-6 lg:px-8 py-6 space-y-6">
        <!-- ================= TRADING ANALYSIS ================= -->
        <section id="trading-analysis" class="space-y-4">
          <!-- Title + Segmented Controls -->
          <div class="flex flex-col gap-3 md:flex-row md:items-end md:justify-between">
            <div class="space-y-1">
              <h1 class="text-2xl md:text-3xl font-semibold">Trading Analysis</h1>
              <p class="text-sm">Detailed performance and bias across spot and derivatives.</p>
            </div>

            <form id="ta-controls" class="grid grid-cols-1 gap-2 sm:grid-cols-3 md:auto-cols-max md:grid-flow-col">
              <!-- Metric -->
              <fieldset class="flex flex-wrap items-center gap-2">
                <legend class="text-xs uppercase tracking-wide">Metric</legend>
                <div class="flex gap-1">
                  <label class="inline-flex items-center gap-2 px-3 h-9 rounded border">
                    <input type="radio" name="metric" value="pnl" checked />
                    <span class="text-sm">P&amp;L</span>
                  </label>
                  <label class="inline-flex items-center gap-2 px-3 h-9 rounded border">
                    <input type="radio" name="metric" value="roi" />
                    <span class="text-sm">ROI</span>
                  </label>
              </div>
              </fieldset>

              <!-- Market -->
              <fieldset class="flex flex-wrap items-center gap-2">
                <legend class="text-xs uppercase tracking-wide">Market</legend>
                <div class="flex gap-1">
                  <label class="inline-flex items-center gap-2 px-3 h-9 rounded border">
                    <input type="radio" name="market" value="combined" checked />
                    <span class="text-sm">Combined</span>
                  </label>
                  <label class="inline-flex items-center gap-2 px-3 h-9 rounded border">
                    <input type="radio" name="market" value="perp" />
                    <span class="text-sm">Perp</span>
                  </label>
                  <label class="inline-flex items-center gap-2 px-3 h-9 rounded border">
                    <input type="radio" name="market" value="spot" />
                    <span class="text-sm">Spot</span>
                  </label>
              </div>
              </fieldset>

              <!-- Timeframe -->
              <fieldset class="flex flex-wrap items-center gap-2">
                <legend class="text-xs uppercase tracking-wide">Timeframe</legend>
                <div class="flex gap-1">
                  <label class="inline-flex items-center gap-2 px-3 h-9 rounded border">
                    <input type="radio" name="tf" value="24h" checked />
                    <span class="text-sm">24H</span>
                  </label>
                  <label class="inline-flex items-center gap-2 px-3 h-9 rounded border">
                    <input type="radio" name="tf" value="7d" />
                    <span class="text-sm">7D</span>
                  </label>
                  <label class="inline-flex items-center gap-2 px-3 h-9 rounded border">
                    <input type="radio" name="tf" value="30d" />
                    <span class="text-sm">30D</span>
                  </label>
                  <label class="inline-flex items-center gap-2 px-3 h-9 rounded border">
                    <input type="radio" name="tf" value="all" />
                    <span class="text-sm">All</span>
                  </label>
            </div>
              </fieldset>
            </form>
          </div>

          <!-- Left metrics + Right chart/KPIs -->
          <div class="grid grid-cols-1 lg:grid-cols-3 gap-4">
            <!-- Left -->
            <div class="space-y-4">
              <article class="p-4 rounded border">
                <p class="text-sm">Account Value</p>
                <p id="account-value-amount" class="text-3xl font-semibold tracking-tight">$87,607.37</p>
                <div class="mt-2 text-sm">24H change: <span id="account-value-change">+3.59%</span></div>
              </article>

              <article class="p-4 rounded border space-y-3">
                <div class="flex items-center justify-between">
                  <span class="text-sm">Recently Traded</span>
                  <div class="flex -space-x-2">
                    <div class="h-6 w-6 rounded overflow-hidden border"></div>
                    <div class="h-6 w-6 rounded overflow-hidden border"></div>
                    <div class="h-6 w-6 rounded overflow-hidden border"></div>
                  </div>
                </div>
                
                <div class="flex items-center justify-between">
                  <span class="text-sm">Directional Bias</span>
                  <span class="text-sm font-medium">Mostly Long</span>
                </div>

                <div class="grid grid-cols-2 gap-3">
                  <div class="p-3 rounded border">
                    <p class="text-xs">Win Rate</p>
                    <p class="text-lg font-semibold tracking-tight">54.0%</p>
                  </div>
                  <div class="p-3 rounded border">
                    <p class="text-xs">Sharpe (30D)</p>
                    <p class="text-lg font-semibold tracking-tight">1.12</p>
                  </div>
                </div>

                <label class="flex items-center gap-2">
                  <input id="feesToggle" type="checkbox" />
                  <span class="text-xs">Include fees in P&amp;L</span>
                </label>
              </article>
            </div>

            <!-- Right -->
            <div class="lg:col-span-2 space-y-4">
              <article class="p-4 rounded border">
                <div class="flex items-center justify-between">
                  <div class="text-xs">P&amp;L vs Benchmark</div>
                </div>
                <div class="mt-3 h-[300px]">
                  <canvas id="pnlChart" class="h-full w-full"></canvas>
                </div>
              </article>

              <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
                <div class="p-3 rounded border">
                  <p class="text-xs">Total P&amp;L</p>
                  <p id="kpiTotal" class="text-lg font-semibold tracking-tight">-$304.88</p>
                </div>
                <div class="p-3 rounded border">
                  <p class="text-xs">Perpetual P&amp;L</p>
                  <p id="kpiPerp" class="text-lg font-semibold tracking-tight">-$205.45</p>
                </div>
                <div class="p-3 rounded border">
                  <p class="text-xs">Spot P&amp;L</p>
                  <p id="kpiSpot" class="text-lg font-semibold tracking-tight">-$99.43</p>
              </div>
                <div class="p-3 rounded border">
                  <p class="text-xs">Avg Trade Duration</p>
                  <p class="text-lg font-semibold tracking-tight">6h 12m</p>
              </div>
              </div>
            </div>
          </div>
        </section>

        <!-- ================= HISTORICAL BREAKDOWN ================= -->
        <section id="historical-breakdown" class="space-y-4">
          <div>
            <h2 class="text-xl md:text-2xl font-semibold tracking-tight">Historical Breakdown</h2>
            <p class="text-sm">Calendar returns, asset profitability, and trade history.</p>
          </div>

          <!-- Tabs -->
          <div class="flex items-center gap-6 border-b">
            <button id="tabbtn-calendar" class="py-2 text-sm -mb-px border-b-2">Trading Calendar</button>
            <button id="tabbtn-assets"   class="py-2 text-sm">Asset Profitability</button>
            <button id="tabbtn-trades"   class="py-2 text-sm">Completed Trades</button>
            <button id="tabbtn-fills"    class="py-2 text-sm">Fills History</button>
            <button id="tabbtn-funding"  class="py-2 text-sm">Funding History</button>
          </div>

          <!-- TAB: Calendar -->
          <div id="tab-calendar" class="space-y-4">
            <!-- Calendar controls -->
            <div class="flex items-center justify-between">
              <div class="flex items-center gap-2">
                <button id="prevMonth" class="h-9 w-9 rounded border">&lt;</button>
                <div id="monthLabel" class="px-3 h-9 rounded border grid place-items-center">August 2025</div>
                <button id="nextMonth" class="h-9 w-9 rounded border">&gt;</button>
                    </div>
              <div class="flex items-center gap-3 text-xs">
                <span>Legend</span>
                <span class="inline-flex items-center gap-1">● Profit</span>
                <span class="inline-flex items-center gap-1">● Loss</span>
                    </div>
                  </div>

            <!-- Month summary -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-3">
              <div class="p-3 rounded border">
                <p class="text-xs">P&amp;L (Month)</p>
                <p id="calPnl" class="text-lg font-semibold tracking-tight">-$12,632.20</p>
                </div>
              <div class="p-3 rounded border">
                <p class="text-xs">Volume</p>
                <p id="calVol" class="text-lg font-semibold tracking-tight">$613,606.91</p>
              </div>
              <div class="p-3 rounded border">
                <p class="text-xs">Most Profitable</p>
                <p id="calBest" class="text-lg font-semibold tracking-tight">ETH +$422.42</p>
                    </div>
              <div class="p-3 rounded border">
                <p class="text-xs">Win Rate</p>
                <p id="calWin" class="text-lg font-semibold tracking-tight">50%</p>
                    </div>
                  </div>

            <!-- Calendar grid -->
            <div class="p-3 md:p-4 rounded border space-y-2">
              <div class="grid grid-cols-7 gap-2 text-xs">
                <div class="text-center">Sun</div>
                <div class="text-center">Mon</div>
                <div class="text-center">Tue</div>
                <div class="text-center">Wed</div>
                <div class="text-center">Thu</div>
                <div class="text-center">Fri</div>
                <div class="text-center">Sat</div>
              </div>
              <div id="calendarGrid" class="grid grid-cols-7 gap-2"></div>
                    </div>
                  </div>

          <!-- TAB: Assets -->
          <div id="tab-assets" class="hidden space-y-4">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-4">
              <article class="p-4 rounded border">
                <h3 class="text-lg font-semibold tracking-tight">Allocation</h3>
                <p class="text-xs">Holdings distribution</p>
                <div class="mt-3 h-[260px]">
                  <canvas id="allocChart" class="h-full w-full"></canvas>
                </div>
              </article>

              <article class="p-4 rounded border lg:col-span-2">
                <h3 class="text-lg font-semibold tracking-tight">Asset Profitability</h3>
                <p class="text-xs">Top performers this month</p>
                <div class="mt-3 grid grid-cols-2 md:grid-cols-4 gap-3">
                  <div class="p-3 rounded border">
                    <div class="flex items-center justify-between text-xs"><span>BTC</span><span>+4.2%</span></div>
                    <p class="mt-1 text-lg font-semibold tracking-tight">$42,106</p>
              </div>
                  <div class="p-3 rounded border">
                    <div class="flex items-center justify-between text-xs"><span>ETH</span><span>+6.8%</span></div>
                    <p class="mt-1 text-lg font-semibold tracking-tight">$21,488</p>
                    </div>
                  <div class="p-3 rounded border">
                    <div class="flex items-center justify-between text-xs"><span>SOL</span><span>-1.3%</span></div>
                    <p class="mt-1 text-lg font-semibold tracking-tight">$8,911</p>
                    </div>
                  <div class="p-3 rounded border">
                    <div class="flex items-center justify-between text-xs"><span>USDT</span><span>—</span></div>
                    <p class="mt-1 text-lg font-semibold tracking-tight">$15,102</p>
                  </div>
                </div>
              </article>
            </div>
          </div>

          <!-- TAB: Trades -->
          <div id="tab-trades" class="hidden space-y-3">
            <div class="rounded border overflow-hidden">
              <div class="grid grid-cols-12 px-4 py-3 text-xs border-b">
                <div class="col-span-3">Time</div>
                <div class="col-span-2">Pair</div>
                <div class="col-span-2">Side</div>
                <div class="col-span-2">Size</div>
                <div class="col-span-3 text-right">P&amp;L</div>
              </div>
              <div class="divide-y">
                <div class="grid grid-cols-12 px-4 py-3 text-sm">
                  <div class="col-span-3">2025-08-14 10:22</div>
                  <div class="col-span-2">ETH/USDT</div>
                  <div class="col-span-2">Long</div>
                  <div class="col-span-2">$12,500</div>
                  <div class="col-span-3 text-right">+$422.42</div>
              </div>
                <div class="grid grid-cols-12 px-4 py-3 text-sm">
                  <div class="col-span-3">2025-08-14 15:04</div>
                  <div class="col-span-2">BTC/USDT</div>
                  <div class="col-span-2">Short</div>
                  <div class="col-span-2">$35,000</div>
                  <div class="col-span-3 text-right">-$356.22</div>
              </div>
                <div class="grid grid-cols-12 px-4 py-3 text-sm">
                  <div class="col-span-3">2025-08-12 08:40</div>
                  <div class="col-span-2">SOL/USDT</div>
                  <div class="col-span-2">Long</div>
                  <div class="col-span-2">$4,800</div>
                  <div class="col-span-3 text-right">+$98.60</div>
              </div>
              </div>
            </div>
          </div>

          <!-- TAB: Fills -->
          <div id="tab-fills" class="hidden space-y-3">
            <div class="rounded border overflow-hidden">
              <div class="grid grid-cols-12 px-4 py-3 text-xs border-b">
                <div class="col-span-3">Time</div>
                <div class="col-span-3">Pair</div>
                <div class="col-span-3">Price</div>
                <div class="col-span-3 text-right">Fee</div>
              </div>
              <div class="divide-y text-sm">
                <div class="grid grid-cols-12 px-4 py-3">
                  <div class="col-span-3">2025-08-14 10:22:19</div>
                  <div class="col-span-3">ETH/USDT</div>
                  <div class="col-span-3">$2,498.12</div>
                  <div class="col-span-3 text-right">$-1.12</div>
                </div>
                <div class="grid grid-cols-12 px-4 py-3">
                  <div class="col-span-3">2025-08-14 15:04:02</div>
                  <div class="col-span-3">BTC/USDT</div>
                  <div class="col-span-3">$61,202.30</div>
                  <div class="col-span-3 text-right">$-2.44</div>
                </div>
              </div>
            </div>
          </div>

          <!-- TAB: Funding -->
          <div id="tab-funding" class="hidden space-y-3">
            <div class="rounded border overflow-hidden">
              <div class="grid grid-cols-12 px-4 py-3 text-xs border-b">
                <div class="col-span-4">Time</div>
                <div class="col-span-4">Market</div>
                <div class="col-span-4 text-right">Funding</div>
              </div>
              <div class="divide-y text-sm">
                <div class="grid grid-cols-12 px-4 py-3">
                  <div class="col-span-4">2025-08-14 04:00</div>
                  <div class="col-span-4">BTC-PERP</div>
                  <div class="col-span-4 text-right">+$6.20</div>
              </div>
                <div class="grid grid-cols-12 px-4 py-3">
                  <div class="col-span-4">2025-08-13 20:00</div>
                  <div class="col-span-4">ETH-PERP</div>
                  <div class="col-span-4 text-right">-$3.42</div>
              </div>
              </div>
            </div>
          </div>
        </section>
        <!-- ================= SECONDARY CHARTS ================= -->
        <section class="grid grid-cols-1 lg:grid-cols-3 gap-4">
          <article class="p-4 rounded border">
            <h3 class="text-lg font-semibold tracking-tight">Drawdown (30D)</h3>
            <p class="text-xs">Max vs current</p>
            <div class="mt-3 h-[220px]">
              <canvas id="ddChart" class="h-full w-full"></canvas>
            </div>
          </article>

          <article class="p-4 rounded border">
            <h3 class="text-lg font-semibold tracking-tight">Win/Loss by Weekday</h3>
            <p class="text-xs">Trade outcomes</p>
            <div class="mt-3 h-[220px]">
              <canvas id="wlChart" class="h-full w-full"></canvas>
            </div>
          </article>

          <article class="p-4 rounded border">
            <h3 class="text-lg font-semibold tracking-tight">Fees (30D)</h3>
            <p class="text-xs">Impact on net returns</p>
            <div class="mt-3 h-[220px]">
              <canvas id="feeChart" class="h-full w-full"></canvas>
        </div>
          </article>
        </section>
      </section>

      <!-- TOAST -->
      <div id="toast" class="fixed bottom-4 right-4 hidden items-center gap-3 px-4 h-12 rounded border">
        <span class="text-sm">Updated time range</span>
    </div>
  </div>

  <script src="assets/js/components.js"></script>
  <script>
    // Initialize icons and charts
    document.addEventListener('DOMContentLoaded', () => {
      if (window.lucide && lucide.createIcons) {
        lucide.createIcons();
      }
      initCharts();
      initTabs();
      initCalendar();
    });

    // Initialize all charts
    function initCharts() {
      // P&L vs Benchmark Chart
      const pnlCtx = document.getElementById('pnlChart').getContext('2d');
      new Chart(pnlCtx, {
        type: 'line',
        data: {
          labels: Array.from({length: 30}, (_, i) => i + 1),
          datasets: [{
            label: 'P&L',
            data: Array.from({length: 30}, () => Math.random() * 100 - 50),
            borderColor: '#10B981',
            tension: 0.4
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: { legend: { display: false } }
        }
      });

      // Allocation Chart
      const allocCtx = document.getElementById('allocChart').getContext('2d');
      new Chart(allocCtx, {
        type: 'doughnut',
        data: {
          labels: ['BTC', 'ETH', 'SOL', 'USDT'],
          datasets: [{
            data: [42, 21, 8, 15],
            backgroundColor: ['#3B82F6', '#10B981', '#F59E0B', '#6B7280']
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false
        }
      });

      // Drawdown Chart
      const ddCtx = document.getElementById('ddChart').getContext('2d');
      new Chart(ddCtx, {
        type: 'line',
        data: {
          labels: Array.from({length: 30}, (_, i) => i + 1),
          datasets: [{
            label: 'Drawdown',
            data: Array.from({length: 30}, () => Math.random() * -10),
            borderColor: '#EF4444',
            fill: true,
            backgroundColor: 'rgba(239, 68, 68, 0.1)'
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: { legend: { display: false } }
        }
      });

      // Win/Loss Chart
      const wlCtx = document.getElementById('wlChart').getContext('2d');
      new Chart(wlCtx, {
        type: 'bar',
        data: {
          labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri'],
          datasets: [{
            label: 'Win Rate',
            data: [65, 45, 73, 58, 62],
            backgroundColor: '#10B981'
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: { legend: { display: false } }
        }
      });

      // Fees Chart
      const feeCtx = document.getElementById('feeChart').getContext('2d');
      new Chart(feeCtx, {
        type: 'line',
        data: {
          labels: Array.from({length: 30}, (_, i) => i + 1),
          datasets: [{
            label: 'Fees',
            data: Array.from({length: 30}, () => Math.random() * 20),
            borderColor: '#8B5CF6'
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: { legend: { display: false } }
        }
      });
    }

    // Initialize tab switching
    function initTabs() {
      const tabs = ['calendar', 'assets', 'trades', 'fills', 'funding'];
      tabs.forEach(tab => {
        document.getElementById(`tabbtn-${tab}`).addEventListener('click', () => {
          // Hide all tabs
          tabs.forEach(t => {
            document.getElementById(`tab-${t}`).classList.add('hidden');
            document.getElementById(`tabbtn-${t}`).classList.remove('border-accent');
          });
          // Show selected tab
          document.getElementById(`tab-${tab}`).classList.remove('hidden');
          document.getElementById(`tabbtn-${tab}`).classList.add('border-accent');
        });
      });
    }

    // Initialize calendar
    function initCalendar() {
      const grid = document.getElementById('calendarGrid');
      const days = Array.from({length: 35}, (_, i) => {
        const day = document.createElement('div');
        day.className = 'calendar-day';
        if (i < 3 || i > 30) {
          day.classList.add('empty');
        } else {
          day.innerHTML = `
            <div class="text-right mb-2">${i - 2}</div>
            <div class="text-xs text-right ${Math.random() > 0.5 ? 'text-emerald-400' : 'text-red-400'}">
              ${(Math.random() * 1000 - 500).toFixed(2)}
            </div>
          `;
          day.classList.add(Math.random() > 0.5 ? 'profit' : 'loss');
        }
        return day;
      });
      grid.append(...days);
    }

    // Show toast message
    function showToast(message) {
      const toast = document.getElementById('toast');
      toast.querySelector('span').textContent = message;
      toast.classList.remove('hidden');
      toast.classList.add('flex');
      setTimeout(() => {
        toast.classList.remove('flex');
        toast.classList.add('hidden');
      }, 3000);
    }

    // Form controls
    document.getElementById('ta-controls').addEventListener('change', (e) => {
      if (e.target.matches('input[type="radio"]')) {
        showToast('Updating time range...');
      }
    });

    document.getElementById('feesToggle').addEventListener('change', (e) => {
      showToast(e.target.checked ? 'Including fees in P&L' : 'Excluding fees from P&L');
    });
  </script>
</body>
</html>
